{% extends 'app/base.html' %}
{% load static %}

{% block title %}Browse Donations | Share A Spoon{% endblock %}

{% block content %}
<nav aria-label="breadcrumb" class="mb-4">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'app:home' %}">Home</a></li>
        <li class="breadcrumb-item active" aria-current="page">Browse Donations</li>
    </ol>
</nav>

<h2>All Donations</h2>

<!-- Filter Form -->
<form method="get" class="my-4">
    <!-- Filter by Quantity Threshold -->
    <div class="mb-3">
        <label for="quantity" class="form-label">Minimum Quantity</label>
        <input type="number" name="quantity" min="1" value="{{ request.GET.quantity }}" class="form-control"
            style="max-width: 200px;">
    </div>
    
    <!-- <div class="mb-3">
            <label for="category" class="form-label">Category</label>
            <select name="category" class="form-select" style="max-width: 200px;">
                <option value="cooked" {% if request.GET.category == 'cooked' %}selected{% endif %}>Cooked Food</option>
                <option value="packaged" {% if request.GET.category == 'packaged' %}selected{% endif %}>Packaged Food</option>
                <option value="canned" {% if request.GET.category == 'canned' %}selected{% endif %}>Canned Goods</option>
                <option value="baked" {% if request.GET.category == 'baked' %}selected{% endif %}>Baked Goods</option>
                <option value="others" {% if request.GET.category == 'others' %}selected{% endif %}>Others</option>
            </select>
        </div> -->
    
    <!-- Filter by Sorting Criteria -->
    <select name="filter" onchange="this.form.submit()" class="form-select" style="max-width: 200px;">
        <option value="expiry" {% if request.GET.filter == 'expiry' %}selected{% endif %}>Sort by Expiry Date</option>
        <option value="quantity" {% if request.GET.filter == 'quantity' %}selected{% endif %}>Sort by Quantity</option>
        <!-- <option value="rating">Sort by Rating</option> -->
    </select>
</form>

<!-- Donations -->
{% if donations %}
<div class="row row-cols-2 row-cols-md-3 row-cols-lg-4 g-4">
    {% for donation in donations %}
    <div class="col">
        <div class="card h-100">
            {% if donation.image %}
            <img src="{{ donation.image.url }}" class="card-img-top fixed-image" alt="{{ donation.food_name }}">
            {% else %}
            <img src="{% static 'images/icon.png' %}" class="card-img-top fixed-image" alt="No Image">
            {% endif %}
            <div class="card-body">
                <h5 class="card-title">
                    <a href="{% url 'donation:donation_detail' donation.pk %}" class="text-decoration-none">
                        {{ donation.food_name }}
                    </a>
                </h5>
                <p class="card-text">Quantity: {{ donation.quantity }}</p>
                <p class="card-text">Expiry Date: {{ donation.expiry_date }}</p>
            </div>
        </div>
    </div>
    {% endfor %}
</div>
{% else %}
<div class="alert alert-info">No donations available at the moment.</div>
{% endif %}
{% endblock %}